<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMBaTuBes - Penilaian</title>
    <link rel="stylesheet" th:href="@{/css/dosenPenilaian.css}">
    <script type="text/javascript" th:src="@{/js/dosenPenilaian.js}" defer></script>
</head>
<body>
    <header class="top-navbar">
        <div class="header-content">
            <div class="brand">
                <span class="logo-text">AMBaTuBes</span>
                <span class="separator">|</span>
                <nav class="breadcrumb">
                    <a th:href="@{/dosen/tubes(kelasId=${kelasId})}">Dashboard</a>
                    <span class="divider">/</span>
                    <a th:href="@{/dosen/tubes(kelasId=${kelasId})}">Tubes</a>
                    <span class="divider">/</span>
                    <span class="current">Penilaian</span>
                </nav>
            </div>

            <div class="user-controls">
                <div class="user-initials">PP</div>
                <button class="logout-btn">
                    <img src="icons/exit.png" alt="Logout" class="icon-img">
                </button>
            </div>
        </div>
    </header>

    <div class="horizontal-progress-wrap">
        <div class="progress-bar-container horizontal">
            <div class="step">
                <span class="step-num">1</span>
                <span class="step-desc">Detail Tugas</span>
            </div>
            <div class="step">
                <span class="step-num">2</span>
                <span class="step-desc">Upload Jadwal</span>
            </div>
            <div class="step">
                <span class="step-num">3</span>
                <span class="step-desc">Upload Rubrik</span>
            </div>
            <div class="step">
                <span class="step-num">4</span>
                <span class="step-desc">Buat Kelompok</span>
            </div>
            <div class="step active">
                <span class="step-num">5</span>
                <span class="step-desc">Penilaian</span>
            </div>
        </div>
    </div>

    <main>
        <div class="content">
            <div class="page-title-container">
                <h1 class="page-title">Penilaian</h1>
            </div>

            <!-- Tabel Deadline -->
            <div class="deadline-section">
                <div class="table-title-container">
                    <h2 class="table-title">Deadline</h2>
                </div>
                <div class="table-card">
                    <table class="deadline-table">
                        <thead>
                            <tr>
                                <th>Kegiatan</th>
                                <th>Awal</th>
                                <th>Akhir</th>
                                <th>Input Nilai</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="jadwal : ${jadwalList}">
                                <td th:text="${jadwal.namaKegiatan}">Kegiatan</td>
                                <td th:text="${#dates.format(jadwal.deadline, 'dd MMM yyyy')}">Awal</td>
                                <td th:text="${#dates.format(jadwal.deadline, 'dd MMM yyyy')}">Akhir</td>
                                <td>
                                    <button class="input-nilai-btn" type="button" th:attr="data-idkegiatan=${jadwal.idKegiatan}">Input Nilai</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tabel Kelompok untuk Penilaian -->
            <div class="kelompok-penilaian-section">
                <div class="table-title-container">
                    <h2 class="table-title">Kelompok</h2>
                </div>
                <div class="table-card">
                    <table class="kelompok-penilaian-table">
                        <thead>
                            <tr>
                                <th>Kelompok</th>
                                <th>Nilai Pertemuan 1</th>
                                <th>Nilai Presentasi</th>
                                <th>Nilai Demo</th>
                                <th>Nilai Laporan</th>
                                <th>Nilai Akhir</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="k : ${kelompokList}">
                                <td class="kelompok-nama" th:text="${'Kelompok ' + k.namaKelompok}">Kelompok</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-akhir">-</td>
                                <td>
                                    <button class="detail-nilai-btn" type="button" th:attr="data-kelompok=${k.namaKelompok}">Detail Nilai</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="kelompok-nama">Kelompok B</td>
                                <td class="nilai-cell">78</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-akhir">-</td>
                                <td>
                                    <button class="detail-nilai-btn" data-kelompok="B">Detail Nilai</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="kelompok-nama">Kelompok C</td>
                                <td class="nilai-cell">92</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-akhir">-</td>
                                <td>
                                    <button class="detail-nilai-btn" data-kelompok="C">Detail Nilai</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="kelompok-nama">Kelompok D</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-cell">-</td>
                                <td class="nilai-akhir">-</td>
                                <td>
                                    <button class="detail-nilai-btn" data-kelompok="D">Detail Nilai</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Popup Input Nilai -->
    <div class="popup-overlay" id="inputNilaiPopup">
        <div class="popup-content">
            <div class="popup-header">
                <h2 class="popup-title">Input Nilai - <span id="popupKegiatan"></span></h2>
                <button class="close-btn" id="closeNilaiPopup">&times;</button>
            </div>
            <div class="popup-body">
                <!-- Pilihan Tipe Input -->
                <div class="tipe-input-section">
                    <label class="tipe-input-label">Tipe Input:</label>
                    <div class="tipe-input-options">
                        <label class="radio-option">
                            <input type="radio" name="tipeInput" value="kelompok" checked>
                            <span class="radio-custom"></span>
                            Nilai Kelompok
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="tipeInput" value="perorangan">
                            <span class="radio-custom"></span>
                            Nilai Perorangan
                        </label>
                    </div>
                </div>

                <!-- Form Input Nilai Kelompok -->
                <div class="nilai-form" id="formKelompok">
                    <div class="form-group">
                        <label for="kelompokSelect">Pilih Kelompok:</label>
                        <select id="kelompokSelect" class="form-select">
                            <option value="">-- Pilih Kelompok --</option>
                            <option value="A">Kelompok A</option>
                            <option value="B">Kelompok B</option>
                            <option value="C">Kelompok C</option>
                            <option value="D">Kelompok D</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="inputNilaiKelompok">Nilai Kelompok:</label>
                        <input type="number" id="inputNilaiKelompok" class="form-input" min="0" max="100" placeholder="0-100">
                    </div>
                </div>

                <!-- Form Input Nilai Perorangan -->
                <div class="nilai-form" id="formPerorangan" style="display: none;">
                    <div class="form-group">
                        <label for="kelompokSelectPerorangan">Pilih Kelompok:</label>
                        <select id="kelompokSelectPerorangan" class="form-select">
                            <option value="">-- Pilih Kelompok --</option>
                            <option value="A">Kelompok A</option>
                            <option value="B">Kelompok B</option>
                            <option value="C">Kelompok C</option>
                            <option value="D">Kelompok D</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="mahasiswaSelect">Pilih Mahasiswa:</label>
                        <select id="mahasiswaSelect" class="form-select" disabled>
                            <option value="">-- Pilih Mahasiswa --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="inputNilaiPerorangan">Nilai Individu:</label>
                        <input type="number" id="inputNilaiPerorangan" class="form-input" min="0" max="100" placeholder="0-100">
                    </div>
                    <div class="form-group">
                        <label for="catatanNilaiPerorangan">Catatan:</label>
                        <textarea id="catatanNilaiPerorangan" class="form-textarea" placeholder="Tambahkan catatan untuk nilai individu..." rows="3"></textarea>
                    </div>
                </div>
            </div>
            <div class="popup-footer">
                <button class="batal-btn" id="batalInputBtn">Batal</button>
                <button class="simpan-btn" id="simpanNilaiBtn">Simpan Nilai</button>
            </div>
        </div>
    </div>

    <!-- Popup Detail Nilai Kelompok -->
    <div class="popup-overlay" id="detailNilaiPopup">
        <div class="popup-content">
            <div class="popup-header">
                <h2 class="popup-title">Detail Nilai - <span id="popupKelompokNama"></span></h2>
                <button class="close-btn" id="closeDetailPopup">&times;</button>
            </div>
            
            <div class="popup-body">
                <!-- Filter Kegiatan -->
                <div class="tipe-catatan-section"> 
                    <div class="form-group">
                        <label for="filterKegiatanDetail">Filter Kegiatan:</label>
                        <select id="filterKegiatanDetail" class="form-select">
                            <!-- Options akan diisi oleh JavaScript -->
                        </select>
                    </div>
                </div>

                <div class="detail-nilai-list" id="detailNilaiList">
                    <!-- Data akan diisi oleh JavaScript -->
                </div>
            </div>
            
            <div class="popup-footer">
                <button class="tutup-btn" id="tutupDetailBtn">Tutup</button>
            </div>
        </div>
    </div>
</body>
</html>